<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Cross-validation for ptLasso."><title>Cross-validation for ptLasso — cv.ptLasso • ptLasso</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation for ptLasso — cv.ptLasso"><meta property="og:description" content="Cross-validation for ptLasso."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ptLasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ptLasso.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DifferentGroupsTrainAndTest.html">Different groups in train and test data</a>
    <a class="dropdown-item" href="../articles/LearningTheInputGroups.html">Learning the input groups</a>
    <a class="dropdown-item" href="../articles/MultitaskLearning.html">Multitask learning or coaching</a>
    <a class="dropdown-item" href="../articles/MultiResponseData.html">Multi-response data with mixed response types</a>
    <a class="dropdown-item" href="../articles/TimeSeriesData.html">Time series</a>
    <a class="dropdown-item" href="../articles/UsingNonlinearBases.html">Pretraining with nonlinear bases</a>
    <a class="dropdown-item" href="../articles/UnsupervisedPretraining.html">Unsupervised pretraining</a>
    <a class="dropdown-item" href="../articles/ConditionalAverageTreatmentEffect.html">Conditional average treatment effects</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cross-validation for ptLasso</h1>
      
      <div class="d-none name"><code>cv.ptLasso.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cross-validation for <code>ptLasso</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv.ptLasso</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alphalist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"multinomial"</span>, <span class="st">"binomial"</span>, <span class="st">"cox"</span><span class="op">)</span>,</span>
<span>  use.case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inputGroups"</span>, <span class="st">"targetGroups"</span>, <span class="st">"multiresponse"</span><span class="op">)</span>,</span>
<span>  type.measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="st">"mse"</span>, <span class="st">"mae"</span>, <span class="st">"auc"</span>, <span class="st">"deviance"</span>, <span class="st">"class"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  foldid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fitoverall <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fitind <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s <span class="op">=</span> <span class="st">"lambda.min"</span>,</span>
<span>  gamma <span class="op">=</span> <span class="st">"gamma.min"</span>,</span>
<span>  alphahat.choice <span class="op">=</span> <span class="st">"overall"</span>,</span>
<span>  group.intercepts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>x</code> matrix as in <code>ptLasso</code>.</p></dd>


<dt>y</dt>
<dd><p><code>y</code> vector or matrix as in <code>ptLasso</code>.</p></dd>


<dt>groups</dt>
<dd><p>A vector of length nobs indicating to which group each observation belongs. For data with k groups, groups should be coded as integers 1 through k. Only for 'use.case = "inputGroups"'.</p></dd>


<dt>alphalist</dt>
<dd><p>A vector of values of the pretraining hyperparameter alpha. Defaults to <code>seq(0, 1, length.out=11)</code>. This function will do pretraining for each choice of alpha in alphalist and return the CV performance for each alpha.</p></dd>


<dt>family</dt>
<dd><p>Response type as in <code>ptLasso</code>.</p></dd>


<dt>use.case</dt>
<dd><p>The type of grouping observed in the data. Can be one of "inputGroups", "targetGroups" or "multiresponse".</p></dd>


<dt>type.measure</dt>
<dd><p>Measure computed in <code>cv.glmnet</code>, as in <code>ptLasso</code>.</p></dd>


<dt>nfolds</dt>
<dd><p>Number of folds for CV (default is 10). Although <code>nfolds</code>can be as large as the sample size (leave-one-out CV), it is not recommended for large datasets. Smallest value allowable is <code>nfolds = 3</code>.</p></dd>


<dt>foldid</dt>
<dd><p>An optional vector of values between 1 and <code>nfolds</code> identifying what fold each observation is in. If supplied, <code>nfolds</code> can be missing.</p></dd>


<dt>verbose</dt>
<dd><p>If <code>verbose=1</code>, print a statement showing which model is currently being fit.</p></dd>


<dt>fitoverall</dt>
<dd><p>An optional cv.glmnet object specifying the overall model. This should have been trained on the full training data, with the argument keep = TRUE.</p></dd>


<dt>fitind</dt>
<dd><p>An optional list of cv.glmnet objects specifying the individual models. These should have been trained on the training data, with the argumnet keep = TRUE.</p></dd>


<dt>s</dt>
<dd><p>The choice of lambda to be used by all models when estimating the CV performance for each choice of alpha. Defaults to "lambda.min". May be "lambda.1se", or a numeric value. (Use caution when supplying a numeric value: the same lambda will be used for all models.)</p></dd>


<dt>gamma</dt>
<dd><p>For use only when <code>relax = TRUE</code>. The choice of gamma to be used by all models when estimating the CV performance for each choice of alpha. Defaults to "gamma.min". May also be "gamma.1se".</p></dd>


<dt>alphahat.choice</dt>
<dd><p>When choosing alphahat, we may prefer the best performance using all data (<code>alphahat.choice = "overall"</code>) or the best average performance across groups (<code>alphahat.choice = "mean"</code>). This is particularly useful when <code>type.measure</code> is "auc" or "C", because the average performance across groups is different than the performance with the full dataset. The default is "overall".</p></dd>


<dt>group.intercepts</dt>
<dd><p>For 'use.case = "inputGroups"' only. If `TRUE`, fit the overall model with a separate intercept for each group. If `FALSE`, ignore the grouping and fit one overall intercept. Default is `TRUE`.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the `cv.glmnet` function. Notable choices include <code>"trace.it"</code> and <code>"parallel"</code>. If <code>trace.it = TRUE</code>, then a progress bar is displayed for each call to <code>cv.glmnet</code>; useful for big models that take a long time to fit. If <code>parallel = TRUE</code>, use parallel <code>foreach</code> to fit each fold.  Must register parallel before hand, such as <code>doMC</code> or others. Importantly, <code>"cv.ptLasso"</code> does not support the arguments <code>"intercept"</code>, <code>"offset"</code>, <code>"fit"</code> and <code>"check.args"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"cv.ptLasso"</code>, which is a list with the ingredients of the cross-validation fit.</p>
<dl><dt>call</dt>
<dd><p>The call that produced this object.</p></dd>

<dt>alphahat</dt>
<dd><p>Value of <code>alpha</code> that optimizes CV performance on all data.</p></dd>

<dt>varying.alphahat</dt>
<dd><p>Vector of values of <code>alpha</code>, the kth of which optimizes performance for group k.</p></dd>

<dt>alphalist</dt>
<dd><p>Vector of all alphas that were compared.</p></dd>

<dt>errall</dt>
<dd><p>CV performance for the overall model.</p></dd>

<dt>errpre</dt>
<dd><p>CV performance for the pretrained models (one for each <code>alpha</code> tried).</p></dd>

<dt>errind</dt>
<dd><p>CV performance for the individual model.</p></dd>

<dt>fit</dt>
<dd><p>List of <code>ptLasso</code> objects, one for each <code>alpha</code> tried.</p></dd>

<dt>fitoverall</dt>
<dd><p>The fitted overall model used for the first stage of pretraining.</p></dd>

<dt>fitoverall.lambda</dt>
<dd><p>The value of <code>lambda</code> used for the first stage of pretraining.</p></dd>

<dt>fitind</dt>
<dd><p>A list containing one individual model for each group.</p></dd>

<dt>use.case</dt>
<dd><p>The use case: "inputGroups" or "targetGroups".</p></dd>

<dt>family</dt>
<dd><p>The family used.</p></dd>

<dt>type.measure</dt>
<dd><p>The type.measure used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function runs <code>ptLasso</code> once for each requested choice of alpha, and returns the cross validated performance.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ptLasso.html">ptLasso</a></code> and <code><a href="plot.cv.ptLasso.html">plot.cv.ptLasso</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Getting started. First, we simulate data: we need covariates x, response y and group IDs.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">*</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">1000</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xtest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">*</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">1000</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ytest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">groupstest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model fitting</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv.ptLasso(x = x, y = y, groups = groups, family = "gaussian",  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type.measure = "mse", use.case = "inputGroups", group.intercepts = TRUE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type.measure:  mse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            alpha overall   mean wtdMean group_1 group_2 group_3 group_4 group_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall           0.9739 0.9739  0.9739  0.8485  0.9735   1.149  0.9145  0.9838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.0  0.9954 0.9954  0.9954  0.8655  0.9953   1.175  0.9458  0.9954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.1  0.9850 0.9850  0.9850  0.8669  0.9724   1.161  0.9347  0.9904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.2  0.9884 0.9884  0.9884  0.8634  0.9695   1.186  0.9330  0.9897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.3  0.9838 0.9838  0.9838  0.8605  0.9724   1.158  0.9422  0.9863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.4  0.9810 0.9810  0.9810  0.8647  0.9615   1.163  0.9306  0.9853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.5  0.9841 0.9841  0.9841  0.8662  0.9766   1.158  0.9261  0.9934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.6  0.9747 0.9747  0.9747  0.8590  0.9571   1.157  0.9232  0.9771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.7  0.9794 0.9794  0.9794  0.8620  0.9679   1.171  0.9181  0.9777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.8  0.9810 0.9810  0.9810  0.8621  0.9784   1.157  0.9230  0.9843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.9  0.9765 0.9765  0.9765  0.8656  0.9730   1.160  0.9191  0.9646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     1.0  0.9803 0.9803  0.9803  0.8590  0.9759   1.165  0.9312  0.9699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual        0.9803 0.9803  0.9803  0.8590  0.9759   1.165  0.9312  0.9699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (fixed) = 0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (varying):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group_1 group_2 group_3 group_4 group_5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.6     0.6     0.6     0.7     0.9 </span>
<span class="r-in"><span><span class="co"># plot(cvfit) # to see CV performance as a function of alpha </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, <span class="va">xtest</span>, <span class="va">groupstest</span>, s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span> <span class="co"># to predict with held out data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = cvfit, xtest = xtest, groupstest = groupstest,  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     s = "lambda.min") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    3                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   9 (0 common + 9 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 9                          </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, <span class="va">xtest</span>, <span class="va">groupstest</span>, s<span class="op">=</span><span class="st">"lambda.min"</span>, ytest<span class="op">=</span><span class="va">ytest</span><span class="op">)</span> <span class="co"># to also measure performance</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = cvfit, xtest = xtest, groupstest = groupstest,  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ytest = ytest, s = "lambda.min") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance (Mean squared error):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            allGroups  mean group_1 group_2 group_3 group_4 group_5       r^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall        1.141 1.141   1.098   1.136   1.313   1.043   1.115 -0.003342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain       1.148 1.148   1.100   1.177   1.308   1.041   1.116 -0.009888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual     1.149 1.149   1.100   1.182   1.308   1.041   1.116 -0.010818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    3                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   9 (0 common + 9 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 9                          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By default, we used s = "lambda.min" to compute CV performance.</span></span></span>
<span class="r-in"><span><span class="co"># We could instead use s = "lambda.1se":</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>,</span></span>
<span class="r-in"><span>                   s <span class="op">=</span> <span class="st">"lambda.1se"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We could also use the glmnet option relax = TRUE:</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>,</span></span>
<span class="r-in"><span>                   relax <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># And, as we did with lambda, we may want to specify the choice of gamma to compute CV performance:</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>,</span></span>
<span class="r-in"><span>                   relax <span class="op">=</span> <span class="cn">TRUE</span>, gamma <span class="op">=</span> <span class="st">"gamma.1se"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that the first stage of pretraining uses "lambda.1se" and "gamma.1se" by default.</span></span></span>
<span class="r-in"><span><span class="co"># This behavior can be modified by specifying overall.lambda and overall.gamma;</span></span></span>
<span class="r-in"><span><span class="co"># see the documentation for ptLasso for more information.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, we are ready to simulate slightly more realistic data.</span></span></span>
<span class="r-in"><span><span class="co"># This continuous outcome example has k = 5 groups, where each group has 200 observations.</span></span></span>
<span class="r-in"><span><span class="co"># There are scommon = 10 features shared across all groups, and</span></span></span>
<span class="r-in"><span><span class="co"># sindiv = 10 features unique to each group.</span></span></span>
<span class="r-in"><span><span class="co"># n = 1000 and p = 120 (60 informative features and 60 noise features).</span></span></span>
<span class="r-in"><span><span class="co"># The coefficients of the common features differ across groups (beta.common).</span></span></span>
<span class="r-in"><span><span class="co"># In group 1, these coefficients are rep(1, 10); in group 2 they are rep(2, 10), etc.</span></span></span>
<span class="r-in"><span><span class="co"># Each group has 10 unique features, the coefficients of which are all 3 (beta.indiv).</span></span></span>
<span class="r-in"><span><span class="co"># The intercept in all groups is 0.</span></span></span>
<span class="r-in"><span><span class="co"># The variable sigma = 20 indicates that we add noise to y according to 20 * rnorm(n). </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">class.sizes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scommon</span><span class="op">=</span><span class="fl">10</span>; <span class="va">sindiv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">class.sizes</span><span class="op">)</span>; <span class="va">p</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sindiv</span><span class="op">)</span> <span class="op">+</span> <span class="va">scommon</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.common</span><span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span>; <span class="va">beta.indiv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">intercepts</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span><span class="op">=</span><span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="gaussian.example.data.html">gaussian.example.data</a></span><span class="op">(</span>k<span class="op">=</span><span class="va">k</span>, class.sizes<span class="op">=</span><span class="va">class.sizes</span>,</span></span>
<span class="r-in"><span>                            scommon<span class="op">=</span><span class="va">scommon</span>, sindiv<span class="op">=</span><span class="va">sindiv</span>,</span></span>
<span class="r-in"><span>                            n<span class="op">=</span><span class="va">n</span>, p<span class="op">=</span><span class="va">p</span>,</span></span>
<span class="r-in"><span>                            beta.common<span class="op">=</span><span class="va">beta.common</span>, beta.indiv<span class="op">=</span><span class="va">beta.indiv</span>,</span></span>
<span class="r-in"><span>                            intercepts<span class="op">=</span><span class="va">intercepts</span>, sigma<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span>; <span class="va">y</span><span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">y</span>; <span class="va">groups</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outtest</span> <span class="op">=</span> <span class="fu"><a href="gaussian.example.data.html">gaussian.example.data</a></span><span class="op">(</span>k<span class="op">=</span><span class="va">k</span>, class.sizes<span class="op">=</span><span class="va">class.sizes</span>,</span></span>
<span class="r-in"><span>                                scommon<span class="op">=</span><span class="va">scommon</span>, sindiv<span class="op">=</span><span class="va">sindiv</span>,</span></span>
<span class="r-in"><span>                                n<span class="op">=</span><span class="va">n</span>, p<span class="op">=</span><span class="va">p</span>,</span></span>
<span class="r-in"><span>                                beta.common<span class="op">=</span><span class="va">beta.common</span>, beta.indiv<span class="op">=</span><span class="va">beta.indiv</span>,</span></span>
<span class="r-in"><span>                                intercepts<span class="op">=</span><span class="va">intercepts</span>, sigma<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xtest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">x</span>; <span class="va">ytest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">y</span>; <span class="va">groupstest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">groups</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv.ptLasso(x = x, y = y, groups = groups, family = "gaussian",  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type.measure = "mse", use.case = "inputGroups", group.intercepts = TRUE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type.measure:  mse </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            alpha overall  mean wtdMean group_1 group_2 group_3 group_4 group_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall            699.7 699.7   699.7   748.4   501.9   575.6   663.0  1009.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.0   518.6 518.6   518.6   470.1   471.5   547.0   540.7   563.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.1   506.0 506.0   506.0   429.7   452.1   538.7   551.1   558.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.2   495.3 495.3   495.3   393.6   460.6   565.5   530.9   526.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.3   490.4 490.4   490.4   390.4   436.5   546.3   511.6   567.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.4   487.5 487.5   487.5   383.7   438.8   545.6   509.4   560.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.5   481.2 481.2   481.2   364.9   429.7   548.5   513.4   549.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.6   504.1 504.1   504.1   393.1   460.0   586.4   531.9   549.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.7   511.5 511.5   511.5   393.2   462.7   584.3   492.9   624.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.8   509.1 509.1   509.1   382.4   496.2   597.9   503.4   565.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.9   501.5 501.5   501.5   404.0   481.6   581.9   488.3   552.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     1.0   517.1 517.1   517.1   409.1   488.9   612.7   484.7   590.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual         517.1 517.1   517.1   409.1   488.9   612.7   484.7   590.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (fixed) = 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (varying):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group_1 group_2 group_3 group_4 group_5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.5     0.5     0.1     1.0     0.2 </span>
<span class="r-in"><span><span class="co"># plot(cvfit) # to see CV performance as a function of alpha </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, <span class="va">xtest</span>, <span class="va">groupstest</span>, ytest<span class="op">=</span><span class="va">ytest</span>, s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = cvfit, xtest = xtest, groupstest = groupstest,  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ytest = ytest, s = "lambda.min") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance (Mean squared error):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            allGroups  mean group_1 group_2 group_3 group_4 group_5    r^2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall        755.7 755.7   836.0   554.9   565.4   777.9  1044.0 0.5371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain       500.2 500.2   539.0   443.8   553.5   502.5   462.4 0.6936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual     532.8 532.8   584.1   443.2   567.2   550.5   518.9 0.6736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    64                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   92 (21 common + 71 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 109                           </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, we repeat with a binomial outcome.</span></span></span>
<span class="r-in"><span><span class="co"># This example has k = 3 groups, where each group has 100 observations.</span></span></span>
<span class="r-in"><span><span class="co"># There are scommon = 5 features shared across all groups, and</span></span></span>
<span class="r-in"><span><span class="co"># sindiv = 5 features unique to each group.</span></span></span>
<span class="r-in"><span><span class="co"># n = 300 and p = 40 (20 informative features and 20 noise features).</span></span></span>
<span class="r-in"><span><span class="co"># The coefficients of the common features differ across groups (beta.common),</span></span></span>
<span class="r-in"><span><span class="co"># as do the coefficients specific to each group (beta.indiv).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">class.sizes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scommon</span><span class="op">=</span><span class="fl">5</span>; <span class="va">sindiv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">class.sizes</span><span class="op">)</span>; <span class="va">p</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sindiv</span><span class="op">)</span> <span class="op">+</span> <span class="va">scommon</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.common</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.3</span>, <span class="op">-</span><span class="fl">.9</span>, <span class="fl">.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.3</span>, <span class="fl">.9</span>, <span class="fl">.1</span>, <span class="op">-</span><span class="fl">.1</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">.2</span>, <span class="op">-</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta.indiv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>  <span class="fl">0.9</span> <span class="op">*</span> <span class="va">beta.common</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="binomial.example.data.html">binomial.example.data</a></span><span class="op">(</span>k<span class="op">=</span><span class="va">k</span>, class.sizes<span class="op">=</span><span class="va">class.sizes</span>,</span></span>
<span class="r-in"><span>                            scommon<span class="op">=</span><span class="va">scommon</span>, sindiv<span class="op">=</span><span class="va">sindiv</span>,</span></span>
<span class="r-in"><span>                            n<span class="op">=</span><span class="va">n</span>, p<span class="op">=</span><span class="va">p</span>,</span></span>
<span class="r-in"><span>                            beta.common<span class="op">=</span><span class="va">beta.common</span>, beta.indiv<span class="op">=</span><span class="va">beta.indiv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span>; <span class="va">y</span><span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">y</span>; <span class="va">groups</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">group</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outtest</span> <span class="op">=</span> <span class="fu"><a href="binomial.example.data.html">binomial.example.data</a></span><span class="op">(</span>k<span class="op">=</span><span class="va">k</span>, class.sizes<span class="op">=</span><span class="va">class.sizes</span>,</span></span>
<span class="r-in"><span>                                scommon<span class="op">=</span><span class="va">scommon</span>, sindiv<span class="op">=</span><span class="va">sindiv</span>,</span></span>
<span class="r-in"><span>                                n<span class="op">=</span><span class="va">n</span>, p<span class="op">=</span><span class="va">p</span>,</span></span>
<span class="r-in"><span>                                beta.common<span class="op">=</span><span class="va">beta.common</span>, beta.indiv<span class="op">=</span><span class="va">beta.indiv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xtest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">x</span>; <span class="va">ytest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">y</span>; <span class="va">groupstest</span><span class="op">=</span><span class="va">outtest</span><span class="op">$</span><span class="va">groups</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>                   type.measure <span class="op">=</span> <span class="st">"auc"</span>, nfolds<span class="op">=</span><span class="fl">3</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, alphahat.choice<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting overall model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting individual models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting individual model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting individual model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting individual model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 1 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 2 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fitting pretrained model 3 / 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha= 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting pretrained lasso models</span>
<span class="r-in"><span><span class="va">cvfit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cv.ptLasso(x = x, y = y, groups = groups, family = "binomial",  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     type.measure = "auc", nfolds = 3, verbose = TRUE, alphahat.choice = "mean",  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     use.case = "inputGroups", group.intercepts = TRUE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> type.measure:  auc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            alpha overall   mean wtdMean group_1 group_2 group_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall           0.5770 0.5717  0.5717  0.6933  0.5994  0.4223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.0  0.6272 0.6242  0.6242  0.8001  0.6819  0.3905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.1  0.7223 0.7613  0.7613  0.8574  0.7504  0.6761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.2  0.6486 0.7434  0.7434  0.8224  0.7625  0.6453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.3  0.6919 0.7124  0.7124  0.8391  0.7060  0.5921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.4  0.6665 0.7127  0.7127  0.8191  0.7501  0.5688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.5  0.7311 0.7600  0.7600  0.8223  0.7798  0.6778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.6  0.6856 0.7527  0.7527  0.8370  0.7576  0.6635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.7  0.6641 0.6990  0.6990  0.7963  0.7441  0.5566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.8  0.6637 0.7133  0.7133  0.8131  0.7571  0.5696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     0.9  0.6741 0.7470  0.7470  0.8367  0.7809  0.6235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain     1.0  0.5882 0.6894  0.6894  0.7896  0.7112  0.5673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual        0.5882 0.6894  0.6894  0.7896  0.7112  0.5673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (fixed) = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alphahat (varying):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group_1 group_2 group_3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.1     0.9     0.5 </span>
<span class="r-in"><span><span class="co"># plot(cvfit) # to see CV performance as a function of alpha </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, <span class="va">xtest</span>, <span class="va">groupstest</span>, ytest<span class="op">=</span><span class="va">ytest</span>, s<span class="op">=</span><span class="st">"lambda.1se"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = cvfit, xtest = xtest, groupstest = groupstest,  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ytest = ytest, s = "lambda.1se") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance (AUC):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            allGroups   mean wtdMean group_1 group_2 group_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall       0.6070 0.6072  0.6072  0.5985  0.6764  0.5467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain      0.6372 0.6383  0.6383  0.6646  0.7061  0.5443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual    0.6762 0.6435  0.6435  0.6663  0.7644  0.5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    3                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   23 (3 common + 20 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 7                            </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiresponse pretraining</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="va">ntrain</span> <span class="op">=</span> <span class="fl">500</span>;</span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span> <span class="op">-</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta1</span>, <span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mu</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>           <span class="va">mu</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SNR for the two tasks:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SNR for the two tasks: 1.6 1.44</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between two tasks:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, fill<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation between two tasks: 0.5164748</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xtest</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ntrain</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ytest</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">ntrain</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ntrain</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ntrain</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now, we can fit a ptLasso model:</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>, use.case <span class="op">=</span> <span class="st">"multiresponse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot(fit) # to see the cv curve.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">xtest</span><span class="op">)</span> <span class="co"># to predict on new data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = fit, xtest = xtest) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    57                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   23 (19 common + 4 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 80                           </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">xtest</span>, ytest<span class="op">=</span><span class="va">ytest</span><span class="op">)</span> <span class="co"># if ytest is included, we also measure performance</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> predict.cv.ptLasso(object = fit, xtest = xtest, ytest = ytest) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha =  0.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance (Mean squared error):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            allGroups  mean response_1 response_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall        9.394 4.697      4.227      5.168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain       8.907 4.453      4.186      4.721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual     9.465 4.733      4.243      5.222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support size:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Overall    57                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pretrain   23 (19 common + 4 individual)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual 80                           </span>
<span class="r-in"><span><span class="co"># By default, we used s = "lambda.min" to compute CV performance.</span></span></span>
<span class="r-in"><span><span class="co"># We could instead use s = "lambda.1se":</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>, s <span class="op">=</span> <span class="st">"lambda.1se"</span>, use.case <span class="op">=</span> <span class="st">"multiresponse"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We could also use the glmnet option relax = TRUE:</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>, relax <span class="op">=</span> <span class="cn">TRUE</span>, use.case <span class="op">=</span> <span class="st">"multiresponse"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># And, as we did with lambda, we may want to specify the choice of gamma to compute CV performance:</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type.measure <span class="op">=</span> <span class="st">"mse"</span>, relax <span class="op">=</span> <span class="cn">TRUE</span>, gamma <span class="op">=</span> <span class="st">"gamma.1se"</span>, use.case <span class="op">=</span> <span class="st">"multiresponse"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">### Model fitting with parallel = TRUE</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">doMC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">registerDoMC</span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu">cv.ptLasso</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, groups <span class="op">=</span> <span class="va">groups</span>, family <span class="op">=</span> <span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>                   type.measure <span class="op">=</span> <span class="st">"auc"</span>, parallel<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://www.erincraig.me" class="external-link">Erin Craig</a>, <a href="http://statistics.stanford.edu/people/robert-tibshirani" class="external-link">Rob Tibshirani</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

